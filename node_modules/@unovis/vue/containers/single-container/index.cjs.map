{"version":3,"file":"index.cjs","sources":["../../../src/containers/single-container/index.vue"],"sourcesContent":["<script setup lang=\"ts\" generic=\"T\">\nimport { SingleContainer, ComponentCore, SingleContainerConfigInterface, Tooltip, Annotations } from '@unovis/ts'\nimport { onUnmounted, ref, provide, watch, toRefs, watchEffect, reactive, toRaw } from 'vue'\nimport { annotationsAccessorKey, componentAccessorKey, tooltipAccessorKey,  } from \"../../utils/context\"\nimport { useForwardProps } from \"../../utils/props\"\n\nconst props = defineProps<SingleContainerConfigInterface<T> & { data?: T }>()\nconst { data } = toRefs(props)\nconst parsedProps = useForwardProps(props)\n\nlet chart: SingleContainer<T>\nconst config = reactive({\n  component: undefined,\n  tooltip: undefined,\n  annotations: undefined,\n}) as SingleContainerConfigInterface<T>\nconst elRef = ref<HTMLDivElement>()\n\nconst initChart = () => {\n  if (chart) return\n  if (elRef.value && config.component)\n    chart = new SingleContainer(elRef.value, { ...toRaw(config) }, data.value)\n}\n\nwatchEffect(() => {\n  initChart()\n  // watch deep changes in components config\n  const t = config.component?.config\n  chart?.updateContainer({ ...toRaw(parsedProps.value), ...toRaw(config) })\n})\n\nwatch(data, () => {\n  if (chart) {\n    chart.setData(data.value, true)\n  } else {\n    initChart()\n  }\n})\n\nonUnmounted(() => chart?.destroy())\n\nprovide(componentAccessorKey, {\n  data,\n  update: (c: ComponentCore<T>) => config.component = c,\n  destroy: () => config.component = undefined,\n})\n\nprovide(tooltipAccessorKey, {\n  data,\n  update: (t: Tooltip) => config.tooltip = t,\n  destroy: () => { config.tooltip = undefined },\n})\n\nprovide(annotationsAccessorKey, {\n  data,\n  update: (a: Annotations) => config.annotations = a,\n  destroy: () => { config.annotations = undefined },\n})\n\n\ndefineExpose({\n  component: chart\n})\n</script>\n\n<template>\n  <div data-vis-single-container ref=\"elRef\" class='unovis-single-container'>\n    <slot />\n  </div>\n</template>\n\n\n\n<style>\n.unovis-single-container {\n  display: block;\n  position: relative;\n  width: 100%;\n}\n</style>\n"],"names":["props","__props","data","toRefs","parsedProps","useForwardProps","chart","config","reactive","elRef","ref","initChart","SingleContainer","toRaw","watchEffect","_a","watch","onUnmounted","provide","componentAccessorKey","c","tooltipAccessorKey","t","annotationsAccessorKey","a","__expose"],"mappings":"waAMA,MAAMA,EAAQC,EACR,CAAE,KAAAC,CAAA,EAASC,EAAA,OAAOH,CAAK,EACvBI,EAAcC,kBAAgBL,CAAK,EAErC,IAAAM,EACJ,MAAMC,EAASC,EAAAA,SAAS,CACtB,UAAW,OACX,QAAS,OACT,YAAa,MAAA,CACd,EACKC,EAAQC,EAAAA,IAAoB,EAE5BC,EAAY,IAAM,CAClBL,GACAG,EAAM,OAASF,EAAO,YAChBD,EAAA,IAAIM,EAAAA,gBAAgBH,EAAM,MAAO,CAAE,GAAGI,EAAA,MAAMN,CAAM,CAAA,EAAKL,EAAK,KAAK,EAC7E,EAEAY,OAAAA,EAAAA,YAAY,IAAM,OACNH,EAAA,GAEAI,EAAAR,EAAO,YAAP,MAAAQ,EAAkB,OACrBT,GAAA,MAAAA,EAAA,gBAAgB,CAAE,GAAGO,QAAMT,EAAY,KAAK,EAAG,GAAGS,EAAAA,MAAMN,CAAM,GAAG,CACzE,EAEDS,EAAA,MAAMd,EAAM,IAAM,CACZI,EACIA,EAAA,QAAQJ,EAAK,MAAO,EAAI,EAEpBS,EAAA,CACZ,CACD,EAEWM,cAAA,IAAMX,GAAA,YAAAA,EAAO,SAAS,EAElCY,EAAAA,QAAQC,EAAAA,qBAAsB,CAC5B,KAAAjB,EACA,OAASkB,GAAwBb,EAAO,UAAYa,EACpD,QAAS,IAAMb,EAAO,UAAY,MAAA,CACnC,EAEDW,EAAAA,QAAQG,EAAAA,mBAAoB,CAC1B,KAAAnB,EACA,OAASoB,GAAef,EAAO,QAAUe,EACzC,QAAS,IAAM,CAAEf,EAAO,QAAU,MAAA,CAAU,CAC7C,EAEDW,EAAAA,QAAQK,EAAAA,uBAAwB,CAC9B,KAAArB,EACA,OAASsB,GAAmBjB,EAAO,YAAciB,EACjD,QAAS,IAAM,CAAEjB,EAAO,YAAc,MAAA,CAAU,CACjD,EAGYkB,EAAA,CACX,UAAWnB,CAAA,CACZ"}